/*
	CREATE DATABASE A28;
	USE A28;
*/

CREATE TABLE Kupac(
	kupacID int IDENTITY(1,1),
	ime varchar(50),
	prezime varchar(70),
	adresa varchar(100),
	telefon varchar(30)
);

CREATE TABLE Porudzbina(
	porudzbinaID int IDENTITY(1,1),
	kupacID int,
	datum_porucivanja date,
	datum_izvrsenja date
);

CREATE TABLE Jedinica_Mere(
	jedinica_mereID int IDENTITY(1,1),
	jedinica_mere varchar(100)
);

CREATE TABLE Proizvod(
	proizvodID int IDENTITY(1,1),
	proizvod varchar(100),
	jedinica_na_stanju int,
	jedinicaID int,
	nabavna_cena float,
	prodajna_cena float
);

CREATE TABLE Stavke_Porudzbine(
	porudzbinaID int not null,
	proizvodID int not null,
	kolicina int,
	suma float
);

/*Primary keys*/

ALTER TABLE Kupac ADD CONSTRAINT PK_Kupac PRIMARY KEY (kupacID);
ALTER TABLE Porudzbina ADD CONSTRAINT PK_Porudzbina PRIMARY KEY (porudzbinaID);
ALTER TABLE Jedinica_Mere ADD CONSTRAINT PK_Jedinica_Mere PRIMARY KEY (jedinica_mereID);
ALTER TABLE Proizvod ADD CONSTRAINT PK_Proizvod PRIMARY KEY (proizvodID);
ALTER TABLE Stavke_Porudzbine ADD CONSTRAINT PK_Stavke_Porudzbine PRIMARY KEY (porudzbinaID,proizvodID);

INSERT INTO Kupac VALUES
('Kupac1','Kupac1','Adresa1','061321231'),
('Kupac2','Kupac2','Adresa2','061321232'),
('Kupac3','Kupac3','Adresa3','061321233'),
('Kupac4','Kupac4','Adresa4','061321234'),
('Kupac5','Kupac5','Adresa5','061321235'),
('Kupac6','Kupac6','Adresa6','061321236'),
('Kupac7','Kupac7','Adresa7','061321237'),
('Kupac8','Kupac8','Adresa8','061321238'),
('Kupac9','Kupac9','Adresa9','061321239'),
('Kupac10','Kupac10','Adresa10','0613212310'),
('Kupac11','Kupac11','Adresa11','0613212311'),
('Kupac12','Kupac12','Adresa12','0613212312'),
('Kupac13','Kupac13','Adresa13','0613212313'),
('Kupac14','Kupac14','Adresa14','0613212314'),
('Kupac15','Kupac15','Adresa15','0613212315'),
('Kupac16','Kupac16','Adresa16','0613212316'),
('Kupac17','Kupac17','Adresa17','0613212317'),
('Kupac18','Kupac18','Adresa18','0613212318'),
('Kupac19','Kupac19','Adresa19','0613212319'),
('Kupac20','Kupac20','Adresa20','0613212320');

INSERT INTO Porudzbina VALUES
(1,'2022.12.10','2023.1.10'),
(1,'2022.12.2','2023.1.2'),
(1,'2022.12.17','2023.1.17'),
(1,'2022.12.4','2022.12.6'),
(1,'2022.12.5','2023.1.5'),
(2,'2022.12.21','2022.12.23'),
(2,'2022.12.6','2023.1.6'),
(2,'2022.12.3','2023.1.3'),
(2,'2022.12.11','2023.1.11'),
(3,'2022.12.10','2022.12.12'),
(3,'2022.12.11','2023.1.11'),
(3,'2022.12.9','2023.1.9'),
(4,'2022.12.19','2023.1.19'),
(4,'2022.12.21','2023.1.21'),
(4,'2022.12.12','2022.12.14'),
(4,'2022.12.17','2023.1.17'),
(5,'2022.12.23','2022.12.25'),
(5,'2022.12.22','2023.1.22'),
(5,'2022.12.1','2023.1.1'),
(6,'2022.12.21','2023.1.21'),
(6,'2022.12.3','2022.12.5'),
(6,'2022.12.14','2022.12.16'),
(7,'2022.12.16','2023.1.16'),
(7,'2022.12.8','2023.1.8'),
(7,'2022.12.14','2022.12.16'),
(8,'2022.12.11','2023.1.11'),
(8,'2022.12.24','2022.12.26'),
(8,'2022.12.11','2022.12.13'),
(8,'2022.12.10','2023.1.10'),
(9,'2022.12.12','2023.1.12'),
(9,'2022.12.12','2023.1.12'),
(9,'2022.12.5','2022.12.7'),
(9,'2022.12.14','2023.1.14'),
(9,'2022.12.3','2023.1.3'),
(10,'2022.12.15','2023.1.15'),
(10,'2022.12.7','2022.12.9'),
(10,'2022.12.21','2022.12.23'),
(10,'2022.12.13','2022.12.15'),
(10,'2022.12.4','2022.12.6'),
(11,'2022.12.3','2023.1.3'),
(11,'2022.12.20','2022.12.22'),
(11,'2022.12.15','2023.1.15'),
(11,'2022.12.13','2023.1.13'),
(12,'2022.12.23','2023.1.23'),
(12,'2022.12.23','2023.1.23'),
(12,'2022.12.17','2022.12.19'),
(13,'2022.12.24','2022.12.26'),
(13,'2022.12.2','2022.12.4'),
(13,'2022.12.16','2023.1.16'),
(13,'2022.12.7','2023.1.7'),
(13,'2022.12.16','2022.12.18'),
(14,'2022.12.14','2023.1.14'),
(14,'2022.12.24','2022.12.26'),
(14,'2022.12.20','2023.1.20'),
(14,'2022.12.21','2023.1.21'),
(15,'2022.12.21','2023.1.21'),
(15,'2022.12.22','2023.1.22'),
(15,'2022.12.11','2022.12.13'),
(15,'2022.12.17','2022.12.19'),
(15,'2022.12.18','2023.1.18'),
(16,'2022.12.16','2023.1.16'),
(16,'2022.12.19','2023.1.19'),
(16,'2022.12.1','2022.12.3'),
(16,'2022.12.20','2022.12.22'),
(17,'2022.12.8','2022.12.10'),
(17,'2022.12.23','2022.12.25'),
(17,'2022.12.8','2023.1.8'),
(17,'2022.12.17','2022.12.19'),
(18,'2022.12.3','2022.12.5'),
(18,'2022.12.21','2023.1.21'),
(18,'2022.12.4','2023.1.4'),
(18,'2022.12.7','2022.12.9'),
(18,'2022.12.11','2023.1.11'),
(19,'2022.12.3','2022.12.5'),
(19,'2022.12.2','2023.1.2'),
(19,'2022.12.20','2022.12.22'),
(20,'2022.12.6','2022.12.8'),
(20,'2022.12.4','2023.1.4'),
(20,'2022.12.25','2023.1.25'),
(20,'2022.12.10','2023.1.10'),
(20,'2022.12.20','2023.1.20');

INSERT INTO Jedinica_Mere VALUES
	('jedinica1'),
	('jedinica2'),
	('jedinica3');

INSERT INTO Proizvod VALUES
('Proizvod1',36,2,1360.00,1510.00),
('Proizvod2',39,1,118.00,268.00),
('Proizvod3',159,2,1248.00,1398.00),
('Proizvod4',114,3,1093.00,1243.00),
('Proizvod5',123,1,1820.00,1970.00),
('Proizvod6',146,1,1644.00,1794.00),
('Proizvod7',62,1,1269.00,1419.00),
('Proizvod8',59,3,765.00,915.00),
('Proizvod9',165,3,256.00,406.00),
('Proizvod10',83,2,484.00,634.00),
('Proizvod11',74,3,1329.00,1479.00),
('Proizvod12',124,3,400.00,550.00),
('Proizvod13',129,2,134.00,284.00),
('Proizvod14',61,1,713.00,863.00),
('Proizvod15',158,1,1833.00,1983.00),
('Proizvod16',92,1,414.00,564.00),
('Proizvod17',46,1,154.00,304.00),
('Proizvod18',140,3,1371.00,1521.00),
('Proizvod19',21,3,753.00,903.00),
('Proizvod20',102,2,127.00,277.00),
('Proizvod21',33,1,577.00,727.00),
('Proizvod22',132,1,568.00,718.00),
('Proizvod23',134,1,1996.00,2146.00),
('Proizvod24',120,1,1342.00,1492.00),
('Proizvod25',100,2,529.00,679.00),
('Proizvod26',149,2,1760.00,1910.00),
('Proizvod27',187,3,240.00,390.00),
('Proizvod28',166,1,1072.00,1222.00),
('Proizvod29',4,2,1453.00,1603.00),
('Proizvod30',172,2,968.00,1118.00),
('Proizvod31',161,2,1825.00,1975.00),
('Proizvod32',147,1,1062.00,1212.00),
('Proizvod33',28,1,1163.00,1313.00),
('Proizvod34',26,2,1589.00,1739.00),
('Proizvod35',34,2,1522.00,1672.00),
('Proizvod36',20,3,1662.00,1812.00),
('Proizvod37',110,2,797.00,947.00),
('Proizvod38',123,1,854.00,1004.00),
('Proizvod39',15,1,1536.00,1686.00),
('Proizvod40',134,1,440.00,590.00),
('Proizvod41',81,1,808.00,958.00),
('Proizvod42',140,2,681.00,831.00),
('Proizvod43',119,1,576.00,726.00),
('Proizvod44',146,3,1920.00,2070.00),
('Proizvod45',111,2,273.00,423.00),
('Proizvod46',183,1,403.00,553.00),
('Proizvod47',138,2,1827.00,1977.00),
('Proizvod48',139,2,1824.00,1974.00),
('Proizvod49',32,1,752.00,902.00),
('Proizvod50',73,1,1442.00,1592.00);

INSERT INTO Stavke_Porudzbine VALUES
(1,31,4,7900),
(1,33,5,6565),
(1,48,5,9870),
(1,25,2,1358),
(1,10,5,3170),
(1,49,5,4510),
(1,24,4,5968),
(1,5,1,1970),
(1,50,4,6368),
(1,39,1,1686),
(2,29,4,6412),
(2,2,3,804),
(2,44,1,2070),
(2,30,5,5590),
(2,24,5,7460),
(3,8,5,4575),
(3,11,2,2958),
(3,5,5,9850),
(3,16,1,564),
(4,42,3,2493),
(5,32,5,6060),
(5,7,4,5676),
(5,31,5,9875),
(5,12,3,1650),
(5,50,3,4776),
(5,24,1,1492),
(5,4,4,4972),
(5,20,1,277),
(5,36,5,9060),
(6,36,5,9060),
(6,29,4,6412),
(6,31,3,5925),
(6,37,5,4735),
(6,7,3,4257),
(7,50,4,6368),
(7,7,4,5676),
(7,20,4,1108),
(7,38,2,2008),
(7,49,1,902),
(7,13,3,852),
(8,24,3,4476),
(8,13,2,568),
(8,9,2,812),
(9,8,3,2745),
(9,16,5,2820),
(9,42,1,831),
(9,4,2,2486),
(9,29,5,8015),
(9,46,2,1106),
(9,12,4,2200),
(10,19,3,2709),
(10,24,1,1492),
(10,11,2,2958),
(11,24,3,4476),
(11,32,2,2424),
(11,21,5,3635),
(11,15,3,5949),
(12,18,3,4563),
(12,11,1,1479),
(12,5,2,3940),
(12,7,3,4257),
(12,29,2,3206),
(12,49,2,1804),
(12,37,5,4735),
(12,48,2,3948),
(13,13,3,852),
(13,44,5,10350),
(13,17,5,1520),
(13,21,2,1454),
(13,24,5,7460),
(13,43,4,2904),
(13,27,3,1170),
(13,23,5,10730),
(13,15,1,1983),
(13,18,5,7605),
(14,17,1,304),
(15,10,4,2536),
(16,25,2,1358),
(17,30,2,2236),
(17,9,3,1218),
(17,24,3,4476),
(17,45,1,423),
(17,35,5,8360),
(17,34,3,5217),
(17,15,2,3966),
(17,3,4,5592),
(17,27,2,780),
(18,40,3,1770),
(18,21,5,3635),
(18,46,3,1659),
(18,41,4,3832),
(18,35,5,8360),
(19,2,3,804),
(19,28,2,2444),
(19,9,2,812),
(19,16,1,564),
(19,21,4,2908),
(19,12,2,1100),
(19,8,1,915),
(19,34,3,5217),
(19,38,5,5020),
(19,30,2,2236),
(20,47,3,5931),
(20,25,5,3395),
(20,9,2,812),
(20,14,1,863),
(20,34,4,6956),
(20,11,1,1479),
(20,38,5,5020),
(20,6,1,1794),
(20,46,1,553),
(20,41,3,2874),
(21,47,4,7908),
(21,29,2,3206),
(21,14,5,4315),
(21,13,5,1420),
(21,3,5,6990),
(22,32,5,6060),
(23,5,1,1970),
(24,50,5,7960),
(24,3,1,1398),
(24,38,5,5020),
(24,2,2,536),
(24,20,1,277),
(24,29,3,4809),
(25,41,4,3832),
(25,43,3,2178),
(25,50,5,7960),
(25,47,4,7908),
(25,46,3,1659),
(25,2,1,268),
(25,31,5,9875),
(25,6,3,5382),
(25,40,5,2950),
(26,49,3,2706),
(27,49,3,2706),
(27,23,1,2146),
(28,27,5,1950),
(28,44,4,8280),
(28,34,3,5217),
(28,11,1,1479),
(28,16,4,2256),
(28,26,1,1910),
(28,15,1,1983),
(29,4,2,2486),
(29,2,5,1340),
(29,8,1,915),
(29,47,5,9885),
(29,31,2,3950),
(29,28,3,3666),
(29,22,4,2872),
(29,41,3,2874),
(29,1,5,7550),
(30,21,4,2908),
(30,3,5,6990),
(31,31,2,3950),
(31,46,5,2765),
(31,33,2,2626),
(31,38,4,4016),
(32,27,1,390),
(32,34,2,3478),
(32,26,1,1910),
(32,33,4,5252),
(32,9,2,812),
(32,20,1,277),
(32,49,4,3608),
(32,17,3,912),
(32,18,3,4563),
(33,9,4,1624),
(33,12,1,550),
(33,21,4,2908),
(33,18,4,6084),
(34,6,1,1794),
(34,17,3,912),
(35,33,5,6565),
(35,3,3,4194),
(35,39,3,5058),
(35,40,3,1770),
(35,12,4,2200),
(35,31,3,5925),
(35,16,2,1128),
(36,23,3,6438),
(36,7,2,2838),
(36,2,2,536),
(36,36,1,1812),
(36,15,3,5949),
(36,25,1,679),
(36,48,5,9870),
(37,34,2,3478),
(37,16,5,2820),
(37,28,4,4888),
(37,46,4,2212),
(37,12,5,2750),
(37,23,4,8584),
(37,7,3,4257),
(37,41,5,4790),
(37,27,1,390),
(38,27,4,1560),
(38,32,5,6060),
(38,18,2,3042),
(39,24,5,7460),
(39,31,5,9875),
(39,17,4,1216),
(39,47,5,9885),
(40,40,5,2950),
(40,43,2,1452),
(40,27,4,1560),
(40,16,2,1128),
(40,24,1,1492),
(40,50,4,6368),
(40,8,3,2745),
(40,39,1,1686),
(40,2,3,804),
(41,33,1,1313),
(41,39,4,6744),
(41,15,2,3966),
(41,17,3,912),
(41,19,2,1806),
(41,31,5,9875),
(41,44,4,8280),
(41,10,3,1902),
(41,16,1,564),
(41,43,3,2178),
(42,44,2,4140),
(43,32,2,2424),
(43,22,5,3590),
(43,46,3,1659),
(43,25,5,3395),
(43,23,1,2146),
(43,8,5,4575),
(43,4,4,4972),
(43,13,2,568),
(43,49,4,3608),
(43,5,4,7880),
(44,40,2,1180),
(44,34,3,5217),
(44,31,3,5925),
(44,10,1,634),
(45,43,4,2904),
(45,38,5,5020),
(45,49,5,4510),
(45,31,5,9875),
(45,45,4,1692),
(45,22,5,3590),
(45,30,2,2236),
(45,18,4,6084),
(45,42,3,2493),
(46,19,4,3612),
(46,28,3,3666),
(46,43,1,726),
(46,39,2,3372),
(46,16,1,564),
(47,10,2,1268),
(47,4,2,2486),
(47,32,2,2424),
(47,22,3,2154),
(47,6,2,3588),
(47,45,4,1692),
(48,23,1,2146),
(48,12,2,1100),
(48,40,2,1180),
(48,36,2,3624),
(49,50,2,3184),
(49,13,1,284),
(49,47,1,1977),
(49,40,3,1770),
(50,46,4,2212),
(51,15,1,1983),
(51,4,3,3729),
(51,3,1,1398),
(52,27,4,1560),
(52,46,3,1659),
(52,30,4,4472),
(53,3,2,2796),
(54,50,2,3184),
(54,35,2,3344),
(54,44,5,10350),
(54,26,2,3820),
(54,12,2,1100),
(54,41,3,2874),
(54,17,4,1216),
(54,23,5,10730),
(54,42,5,4155),
(54,8,4,3660),
(55,34,2,3478),
(55,12,3,1650),
(55,29,2,3206),
(55,32,2,2424),
(55,25,2,1358),
(55,13,3,852),
(55,30,1,1118),
(55,35,5,8360),
(56,22,1,718),
(56,29,2,3206),
(56,41,5,4790),
(56,23,1,2146),
(56,16,2,1128),
(56,2,4,1072),
(56,44,1,2070),
(56,46,3,1659),
(56,9,2,812),
(57,24,5,7460),
(58,33,5,6565),
(58,1,4,6040),
(58,50,3,4776),
(59,37,4,3788),
(59,39,5,8430),
(59,50,3,4776),
(59,3,1,1398),
(59,30,5,5590),
(59,16,4,2256),
(59,20,2,554),
(59,5,3,5910),
(59,27,4,1560),
(59,7,2,2838),
(60,22,4,2872),
(60,35,3,5016),
(60,23,4,8584),
(60,10,1,634),
(60,46,5,2765),
(60,6,3,5382),
(60,47,5,9885),
(60,30,5,5590),
(61,29,3,4809),
(61,35,4,6688),
(61,28,2,2444),
(61,24,1,1492),
(62,10,1,634),
(62,16,5,2820),
(62,4,2,2486),
(62,30,3,3354),
(62,20,5,1385),
(62,14,4,3452),
(62,26,2,3820),
(63,26,3,5730),
(63,43,2,1452),
(63,50,4,6368),
(63,19,1,903),
(63,46,3,1659),
(63,37,5,4735),
(64,36,1,1812),
(65,32,2,2424),
(65,28,4,4888),
(65,10,2,1268),
(66,10,4,2536),
(66,15,5,9915),
(66,3,5,6990),
(66,44,2,4140),
(66,16,4,2256),
(66,25,3,2037),
(66,37,1,947),
(66,31,4,7900),
(67,34,5,8695),
(68,8,1,915),
(68,21,5,3635),
(68,6,1,1794),
(68,47,2,3954),
(69,27,4,1560),
(69,30,4,4472),
(69,47,1,1977),
(70,43,3,2178),
(70,37,1,947),
(70,32,5,6060),
(70,45,1,423),
(70,47,1,1977),
(70,46,3,1659),
(70,49,3,2706),
(71,48,4,7896),
(71,7,5,7095),
(71,10,5,3170),
(71,41,3,2874),
(71,49,3,2706),
(71,8,2,1830),
(71,34,4,6956),
(72,42,3,2493),
(72,32,1,1212),
(72,27,3,1170),
(72,50,5,7960),
(72,7,5,7095),
(73,33,3,3939),
(73,8,5,4575),
(73,38,2,2008),
(73,48,5,9870),
(73,34,4,6956),
(74,4,4,4972),
(75,35,1,1672),
(75,37,4,3788),
(75,13,3,852),
(75,19,4,3612),
(75,22,4,2872),
(76,30,2,2236),
(76,10,5,3170),
(76,35,3,5016),
(76,27,4,1560),
(76,19,4,3612),
(76,17,4,1216),
(77,35,4,6688),
(77,9,5,2030),
(77,40,2,1180),
(77,44,3,6210),
(77,43,3,2178),
(78,13,5,1420),
(78,21,1,727),
(78,46,1,553),
(79,20,3,831),
(79,34,2,3478),
(79,25,3,2037),
(79,39,2,3372),
(80,16,3,1692),
(80,20,1,277),
(80,42,4,3324),
(80,33,3,3939),
(80,27,5,1950),
(80,8,3,2745),
(80,3,4,5592),
(80,40,5,2950),
(81,42,1,831),
(81,24,5,7460),
(81,13,1,284),
(81,48,2,3948),
(81,39,2,3372),
(81,12,4,2200),
(81,7,3,4257);

/*Foreign keys*/

ALTER TABLE Porudzbina ADD CONSTRAINT FK_Porudzbina_kupacID FOREIGN KEY (kupacID) REFERENCES Kupac(kupacID);
ALTER TABLE Proizvod ADD CONSTRAINT FK_Proizvod_jedinicaID FOREIGN KEY (jedinicaID) REFERENCES Jedinica_Mere(jedinica_mereID);
ALTER TABLE Stavke_Porudzbine ADD CONSTRAINT FK_Stavke_porudzbinaID FOREIGN KEY (porudzbinaID) REFERENCES Porudzbina(porudzbinaID);
ALTER TABLE Stavke_Porudzbine ADD CONSTRAINT FK_Stavke_proizvodID FOREIGN KEY (proizvodID) REFERENCES Proizvod(proizvodID);


/*Dopuna*/

CREATE TABLE Dobavljac(
	dobavljacID int IDENTITY(1,1),
	naziv varchar(100),
	adresa varchar(100),
	grad varchar(100),
	broj_telefona varchar(30),
	email varchar(50)
);

CREATE TABLE Dobavlja_Proizvode(
	dobavljacID int not null,
	proizvodID int not null
);

ALTER TABLE Dobavljac ADD CONSTRAINT PK_Dobavljac PRIMARY KEY (dobavljacID);
ALTER TABLE Dobavlja_Proizvode ADD CONSTRAINT PK_Dobavlja_Proizvode PRIMARY KEY (dobavljacID,proizvodID);
ALTER TABLE Dobavlja_Proizvode ADD CONSTRAINT PK_Dobavlja_Proizvode_proizvodID FOREIGN KEY (proizvodID) REFERENCES Proizvod(proizvodID);
ALTER TABLE Dobavlja_Proizvode ADD CONSTRAINT PK_Dobavlja_Proizvode_dobavljacID FOREIGN KEY (dobavljacID) REFERENCES Dobavljac(dobavljacID);

CREATE TABLE Isporuceni_Proizvodi(
	porudzbinaID int not null,
	proizvodID int not null,
	datum_isporuke date not null
);

ALTER TABLE Isporuceni_Proizvodi ADD CONSTRAINT PK_Isporuceni_Proizvodi PRIMARY KEY (proizvodID,porudzbinaID,datum_isporuke);
ALTER TABLE Isporuceni_Proizvodi ADD CONSTRAINT FK_Isporuceni_Proizvodi_proizvodID FOREIGN KEY (proizvodID) REFERENCES Proizvod(proizvodID);
ALTER TABLE Isporuceni_Proizvodi ADD CONSTRAINT FK_Isporuceni_Proizvodi_porudzbinaID FOREIGN KEY (porudzbinaID) REFERENCES Porudzbina(porudzbinaID);

/*
	USE master;
	DROP DATABASE A28;
*/